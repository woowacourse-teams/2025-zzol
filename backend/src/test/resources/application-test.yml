spring:
  datasource:
    url: jdbc:h2:mem:testdb;
    driver-class-name: org.h2.Driver
    username: sa
    password:
  jpa:
    database-platform: org.hibernate.dialect.H2Dialect  # 이것만 변경!
    hibernate:
      ddl-auto: create-drop
    properties:
      hibernate:
        format_sql: true
        show_sql: false
  lifecycle:
    timeout-per-shutdown-phase: 1s
  flyway:
    enabled: false
  cloud:
    aws:
      region:
        static: ap-northeast-2
  data:
    redis:
      ssl:
        enabled: false
  autoconfigure:
    exclude:
      - org.redisson.spring.starter.RedissonAutoConfigurationV2

redis:
  stream:
    # 공통 기본 설정 (각 스트림에서 오버라이드 가능)
    common-settings:
      max-length: 100
      batch-size: 10
      poll-timeout: 2s

    # 공유 스레드풀
    thread-pools:
      sequential:
        core-size: 1
        max-size: 1
        queue-capacity: 100
      concurrent:
        core-size: 4
        max-size: 8
        queue-capacity: 100

    # 스트림 설정 (key가 식별자)
    keys:
      "[room:broadcast]":
        thread-pool-name: sequential
      "[cardGame:select:broadcast]":
        thread-pool:
          core-size: 1
          max-size: 1
          queue-capacity: 100
      "[minigame:events]":
        thread-pool-name: sequential
      "[racinggame:events]":
        thread-pool-name: concurrent

server:
  shutdown: immediate

redisson:
  enabled: false

logging:
  level:
    org.springframework.web.socket: DEBUG
    org.springframework.messaging: DEBUG
    coffeeshout: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"

management:
  tracing:
    sampling:
      probability: 1.0
  otlp:
    tracing:
      endpoint: http://localhost:4318

room:
  qr:
    prefix: https://coffee-shout.com/join/

otel:
  exporter:
    otlp:
      endpoint: http://localhost:4813

tracing:
  sampling:
    probability: 1.0
